#!/bin/sh

if [ -d "$1" ]; then
	dolphin "$1" &
	exit
elif [ ! -f "$1" ]; then
	echo "$1" not a file, aborting
	exit 1
fi

FILE=$(dirname "$1")/$(basename "$1")
EXTENSION=${FILE##*.}
EXTENSION=${EXTENSION,,} # converted to lowercase

BACKGROUND=true

case $EXTENSION in
  aup) PRG=audacity;;
  chm) PRG=xchm;;
  dvi|ps|pdf|epub) PRG=okular;;
  gif|tiff|tif|jpeg|jpg|png) PRG=gwenview;;
  htm|html) PRG=firefox;;
  k3b) PRG=k3b;;
  ldr|mpd) PRG=leocad;;
  mkv|mp4|m4v) PRG=vlc;;
  odp|pptx) PRG=ooimpress;;
  ods|xls|xlsx) PRG=oocalc;;
  rtf|doc|docx|odt|ott) PRG=oowriter;;
  sh|txt) PRG=vim; BACKGROUND=false;;
  svg) PRG=inkscape;;
  xcf) PRG=gimp;;
  *) echo "Unknown extension '$EXTENSION'"
	  exit 1
     ;;
esac

if [[ "$BACKGROUND" = "true" ]]; then
	$PRG "$FILE" &
else
	$PRG "$FILE"
fi
